function config($stateProvider,$urlRouterProvider,RestangularProvider){RestangularProvider.setBaseUrl("https://leancloud.cn/1.1"),RestangularProvider.setDefaultHeaders({"X-AVOSCloud-Application-Id":"zXmsYkXYionV4s9pHc3IKghD","X-AVOSCloud-Application-Key":"gHmRen4R5I3ziAE7wcP7vKw1"})}function routeConfig($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("app/blank"),$stateProvider.state("signin",{url:"/signin",templateUrl:"modules/signin/signin.html"})}function dataService(Restangular){function getUsers(userId,successCall,errorCall){var userRouter=Restangular.one("users",userId);userRouter.get().then(function(data){successCall(data)},function(error){errorCall(error)})}function getAll(subRouter,queryParams,successCall,errorCall){var getRouter=baseRouter.one(subRouter);getRouter.get(queryParams).then(function(data){successCall(data)},function(error){errorCall(error)})}function get(subRouter,queryParams,successCall,errorCall){var getRouter=baseRouter.one(subRouter);getRouter.get(queryParams).then(function(data){successCall(data)},function(error){errorCall&&errorCall(error)})}function update(subRouter,objId,queryParams,successCall){var singleRouter=baseRouter.one(subRouter,objId);singleRouter.customPUT(queryParams,null,null,header).then(function(data){successCall(data)},function(error){})}function save(subRouter,subObejct,successCall){baseRouter.post(subRouter,subObejct,null,header).then(function(data){successCall(data)},function(error){console.log(error)})}function del(subRouter,objId,queryParams,successCall){var singleRouter=baseRouter.one(subRouter,objId);singleRouter.remove(queryParams,header).then(function(data){successCall(data)},function(error){console.log(error)})}var header={"Content-Type":"application/json"},baseRouter=Restangular.one("classes"),service={getUsers:getUsers,getAll:getAll,get:get,update:update,del:del,save:save};return service}function usersService(Restangular){function get(queryParams,successCall,errorCall){baseRouter.get(queryParams).then(function(data){successCall(data)},function(error){errorCall(error)})}function save(subRouter,subObejct){console.log("save object"),baseRouter.post(subRouter,subObejct,null,header).then(function(data){console.log(data)},function(error){console.log(error)})}var header={"Content-Type":"application/json"},baseRouter=Restangular.one("users"),service={get:get,save:save};return service}function rockUtil($modal,Restangular){function openEditModal(editObj,type,templateUrl,sucCallback,etraObject){var targetEditObject={};if("edit"==type&&1!=editObj.length)alert("务必选择一行数据");else{console.log(type),"edit"==type&&(targetEditObject=angular.copy(editObj[0]));$modal.open({animation:!0,templateUrl:templateUrl,resolve:{operatOpts:function(){var obj={};return obj.editObj=targetEditObject,obj.etra=angular.copy(etraObject),console.log(etraObject),"add"==type&&(obj.oprTitle="新增"),"edit"==type&&(obj.oprTitle="编辑"),obj}},controller:function($scope,$modalInstance,operatOpts){$scope.status={beginOpen:!1,endOpen:!1},$scope.openStartDatePicker=function($event){$scope.status.beginOpen=!0},$scope.openEndDatePicker=function($event){$scope.status.endOpen=!0},$scope.operatOpts=operatOpts,$scope.ok=function(){sucCallback(operatOpts.editObj),$modalInstance.close()},$scope.cancel=function(){$modalInstance.dismiss("cancel")}}})}}var service={openEditModal:openEditModal};return service}function mainCtrl(appName,$scope){$scope.appName=appName}function appConfig($stateProvider){$stateProvider.state("app",{url:"/app","abstract":!0,templateUrl:"modules/component/app/app.html",controller:"app"}).state("app.blank",{url:"/blank",views:{appContentView:{templateUrl:"modules/component/blank/blank.html"}}})}function app(menus,$scope){function activate(){console.log("load app controller success")}$scope.menus=menus,activate()}function appHeader($state,appName,$scope){function direct(menu,index){$scope.data.selectMenu=index,$state.go(menu.url,{menus:menu.subMenus})}$scope.appName=appName,$scope.direct=direct,$scope.data={}}function appSider($stateParams,$state,$scope){function activate(){$scope.$broadcast("collapseAll")}function collapseTree(){$scope.$broadcast("collapseAll")}function toggle(scope){console.log("toggle"),scope.collapsed&&scope.collapseAll(),scope.toggle()}function direct(menu){$scope.data.selectMenu=menu,$state.go(menu.url)}$scope.data={},$scope.data.menus=$stateParams.menus,$scope.data.toggle=toggle,$scope.data.direct=direct,$scope.data.collapseTree=collapseTree,$scope.data.selectMenu,activate()}function contentMgConfig($stateProvider){$stateProvider.state("app.contentMg",{url:"/contentMg",params:{menus:null},views:{appContentView:{templateUrl:"modules/contentMg/contentMg.html",controller:"contentMg"}}}).state("app.contentMg.activityMg",{url:"/activityMg",views:{centerBoard:{templateUrl:"modules/contentMg/activityMg/activityMg.html",controller:"activityMg"}}}).state("app.contentMg.teamMg",{url:"/teamMg",views:{centerBoard:{templateUrl:"modules/contentMg/teamMg/teamMg.html",controller:"teamMg"}}}).state("app.contentMg.styleMg",{url:"/styleMg",views:{centerBoard:{templateUrl:"modules/contentMg/styleMg/styleMg.html",controller:"styleMg"}}}).state("app.contentMg.quoteMg",{url:"/quoteMg",views:{centerBoard:{templateUrl:"modules/contentMg/quoteMg/quoteMg.html",controller:"quoteMg"}}}).state("app.contentMg.projectMg",{url:"/projectMg",views:{centerBoard:{templateUrl:"modules/contentMg/projectMg/projectMg.html",controller:"projectMg"}}}).state("app.contentMg.subscribeMg",{url:"/subscribeMg",views:{centerBoard:{templateUrl:"modules/contentMg/subscribeMg/subscribeMg.html",controller:"subscribeMg"}}})}function contentMg($scope){function activate(){}activate()}function activityMg($scope){function activate(){console.log("load activityMg controller success")}activate()}function projectMg(Project,Team,gridOpts,uiGridConstants,dataService,rockUtil,$scope){function activate(){getAllProject(),console.log("load styleMg controller success")}function editProject(type){function successCall(){return function(targetEditObject){function addSuc(){return function(data){console.log(data),preAddProject.setId(data.objectId),addDataToGrid(preAddProject)}}if("edit"==type)updateProject(selectedRows[0].objectId,Project.build(targetEditObject),function(data){angular.merge(selectedRows[0],targetEditObject)});else{targetEditObject.periodId=0,targetEditObject.periods=new Array;var preAddProject=Project.build(targetEditObject);saveProject(preAddProject,addSuc())}}}var selectedRows=$scope.gridApi.selection.getSelectedRows(),modalObject={};dataService.getUsers(null,function(data){modalObject.users=data.results,getAll(Team.name,function(data){modalObject.jzTeams=data.results,getAll(Team.name,function(data){modalObject.sjTeams=data.results,getAll(Team.name,function(data){modalObject.jlTeams=data.results,rockUtil.openEditModal(selectedRows,type,"editProjectModal.html",successCall(),modalObject)},{where:{type:2}})},{where:{type:1}})},{where:{type:0}})},null)}function delProject(){var delObjes=$scope.gridApi.selection.getSelectedRows();angular.forEach(delObjes,function(data,index){delStyle(data.objectId,function(data){console.log(data)})})}function editPeriod(){function successCall(){return function(targetEditObject){var project=Project.build(selectedRows[0]),period={};period.id=targetEditObject.period.id,period.name=targetEditObject.period.name,period.date=targetEditObject.date,period.images=stringToArray(targetEditObject.images),project.setPeriodId(period.id),project.getPeriods().push(period),updateProject(project.objectId,project,function(data){alert("修改项目阶段成功")})}}var selectedRows=$scope.gridApi.selection.getSelectedRows(),modalObject={};modalObject.periodList=[{id:0,name:"测量设计"},{id:1,name:"水电阶段"},{id:2,name:"泥水阶段"},{id:3,name:"油漆阶段"},{id:4,name:"竣工阶段"},{id:5,name:"软装配饰"}],rockUtil.openEditModal(selectedRows,"add","editPeriodModal.html",successCall(),modalObject)}function stringToArray(string){var origin=angular.copy(string);return origin.split(",")}function setGridData(array){$scope.gridOptions.data=array}function addDataToGrid(obj){$scope.gridOptions.data.push(obj)}function getAll(className,successCall,queryParams){dataService.getAll(className,queryParams,successCall)}function getAllProject(){dataService.getAll(Project.name,null,function(data){setGridData(data.results)})}function saveProject(team,sucCallback){dataService.save(Project.name,team,sucCallback)}function updateProject(objId,queryParams,sucCallback){dataService.update(Project.name,objId,queryParams,sucCallback)}function delStyle(objId,sucCallback){dataService.del(Project.name,objId,null,sucCallback)}var modalObject={};modalObject.teamTypes=[{value:0,name:"家装顾问"},{value:1,name:"设计师"},{value:2,name:"工程监理"}],$scope.data={},$scope.editPeriod=editPeriod,$scope.editProject=editProject,$scope.delProject=delProject,$scope.gridOptions={enableHorizontalScrollbar:uiGridConstants.scrollbars.NEVER,columnDefs:[{field:"objectId",displayName:"项目id",maxWidth:120,width:"30%"},{field:"userId",displayName:"用户Id",maxWidth:150},{field:"styleName",displayName:"项目风格",maxWidth:150},{field:"styleAvatar",displayName:"风格首页图",maxWidth:150},{field:"roomInfo",displayName:"房间信息",maxWidth:150},{field:"periodId",displayName:"项目阶段",maxWidth:150},{field:"startDate",displayName:"开始时间",maxWidth:150},{field:"endDate",displayName:"结束时间",maxWidth:150}],onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.selection.on.rowSelectionChanged($scope,function(row){var selectRowCount=gridApi.selection.getSelectedRows().length;$scope.data.oneRowSelected=!1,$scope.data.multiRowSelected=!1,1===selectRowCount&&($scope.data.oneRowSelected=!0),selectRowCount>1&&($scope.data.multiRowSelected=!0)}),gridApi.selection.on.rowSelectionChangedBatch($scope,function(rows){$scope.data.multiRowSelected=!0})}},angular.merge($scope.gridOptions,gridOpts.exportOpts,gridOpts.baseOpts),activate()}function quoteMg($scope){function activate(){console.log("load quoteMg controller success")}activate()}function styleMg(Style,gridOpts,uiGridConstants,dataService,rockUtil,$scope){function activate(){getAllStyle(),console.log("load styleMg controller success")}function editStyleInfo(type){function sucCallback(){return function(targetEditObject){function addSuc(){return function(data){preAddStyle.setId(data.objectId),addDataToGrid(preAddStyle)}}if("edit"==type)updateStyle(selectedRows[0].objectId,Style.build(targetEditObject),function(data){console.log(data),angular.merge(selectedRows[0],targetEditObject)});else{console.log(targetEditObject.images),targetEditObject.images=stringToArray(targetEditObject.images);var preAddStyle=Style.build(targetEditObject);saveStyle(preAddStyle,addSuc())}}}var selectedRows=$scope.gridApi.selection.getSelectedRows();rockUtil.openEditModal(selectedRows,type,"editStyleModal.html",sucCallback())}function stringToArray(string){var origin=angular.copy(string);return origin.split(",")}function delStyleInfo(){var delObjes=$scope.gridApi.selection.getSelectedRows();angular.forEach(delObjes,function(data,index){delStyle(data.objectId,function(data){console.log(data)})})}function setGridData(array){$scope.styleMgGridOptions.data=array}function addDataToGrid(obj){$scope.styleMgGridOptions.data.push(obj)}function getAllStyle(){dataService.getAll(Style.name,null,function(data){setGridData(data.results),console.log(data.results)})}function saveStyle(style,sucCallback){dataService.save(Style.name,style,sucCallback)}function updateStyle(objId,queryParams,sucCallback){dataService.update(Style.name,objId,queryParams,sucCallback)}function delStyle(objId,sucCallback){dataService.del(Style.name,objId,null,sucCallback)}$scope.data={},$scope.editStyleInfo=editStyleInfo,$scope.delStyleInfo=delStyleInfo,$scope.styleMgGridOptions={enableHorizontalScrollbar:uiGridConstants.scrollbars.NEVER,columnDefs:[{field:"objectId",displayName:"风格id",maxWidth:120,width:"30%"},{field:"name",displayName:"风格名称",maxWidth:150},{field:"avatar",displayName:"风格首页图",maxWidth:150},{field:"images",displayName:"风格详细图",maxWidth:150}],onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.selection.on.rowSelectionChanged($scope,function(row){var selectRowCount=gridApi.selection.getSelectedRows().length;$scope.data.oneRowSelected=!1,$scope.data.multiRowSelected=!1,1===selectRowCount&&($scope.data.oneRowSelected=!0),selectRowCount>1&&($scope.data.multiRowSelected=!0)}),gridApi.selection.on.rowSelectionChangedBatch($scope,function(rows){$scope.data.multiRowSelected=!0})}},angular.merge($scope.styleMgGridOptions,gridOpts.exportOpts,gridOpts.baseOpts),activate()}function subscribeMg($scope){function activate(){console.log("load subscribeMg controller success")}activate()}function teamMg(Team,gridOpts,uiGridConstants,dataService,rockUtil,$scope){function activate(){getAllTeam(),console.log("load styleMg controller success")}function editTeam(type){function successCall(){return function(targetEditObject){function addSuc(){return function(data){preAddTeam.setId(data.objectId),addDataToGrid(preAddTeam)}}if("edit"==type)updateTeam(selectedRows[0].objectId,Team.build(targetEditObject),function(data){angular.merge(selectedRows[0],targetEditObject)});else{var preAddTeam=Team.build(targetEditObject);saveTeam(preAddTeam,addSuc())}}}var selectedRows=$scope.gridApi.selection.getSelectedRows();rockUtil.openEditModal(selectedRows,type,"editTeamModal.html",successCall(),modalObject)}function delTeam(){var delObjes=$scope.gridApi.selection.getSelectedRows();angular.forEach(delObjes,function(data,index){delStyle(data.objectId,function(data){console.log(data)})})}function setGridData(array){$scope.gridOptions.data=array}function addDataToGrid(obj){$scope.gridOptions.data.push(obj)}function getAllTeam(){dataService.getAll(Team.name,null,function(data){setGridData(data.results)})}function saveTeam(team,sucCallback){dataService.save(Team.name,team,sucCallback)}function updateTeam(objId,queryParams,sucCallback){dataService.update(Team.name,objId,queryParams,sucCallback)}function delStyle(objId,sucCallback){dataService.del(Team.name,objId,null,sucCallback)}var modalObject={};modalObject.teamTypes=[{value:0,name:"家装顾问"},{value:1,name:"设计师"},{value:2,name:"工程监理"}],$scope.data={},$scope.editTeam=editTeam,$scope.delTeam=delTeam,$scope.gridOptions={enableHorizontalScrollbar:uiGridConstants.scrollbars.NEVER,columnDefs:[{field:"objectId",displayName:"团队id",maxWidth:120,width:"30%"},{field:"name",displayName:"团队名称",maxWidth:150},{field:"avatar",displayName:"团队头像",maxWidth:150},{field:"type",displayName:"团队类型",maxWidth:150}],onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.selection.on.rowSelectionChanged($scope,function(row){var selectRowCount=gridApi.selection.getSelectedRows().length;$scope.data.oneRowSelected=!1,$scope.data.multiRowSelected=!1,1===selectRowCount&&($scope.data.oneRowSelected=!0),selectRowCount>1&&($scope.data.multiRowSelected=!0)}),gridApi.selection.on.rowSelectionChangedBatch($scope,function(rows){$scope.data.multiRowSelected=!0})}},angular.merge($scope.gridOptions,gridOpts.exportOpts,gridOpts.baseOpts),activate()}function systemMgConfig($stateProvider){$stateProvider.state("app.systemMg",{url:"/systemMg",params:{menus:null},views:{appContentView:{templateUrl:"modules/systemMg/systemMg.html",controller:"systemMg"}}}).state("app.systemMg.staffMg",{url:"/staffMg",views:{centerBoard:{templateUrl:"modules/systemMg/staffMg/staffMg.html",controller:"staffMg"}}}).state("app.systemMg.androidMg",{url:"/androidMg",views:{centerBoard:{templateUrl:"modules/systemMg/androidMg/androidMg.html",controller:"androidMg"}}})}function systemMg($scope){function activate(){}activate()}function staffMg($modal,gridOpts,uiGridConstants,rockUtil,$scope){function activate(){}function deleteStaff(){var selectedRows=$scope.gridApi.selection.getSelectedRows();angular.forEach(selectedRows,function(data,index){$scope.gridOptions.data.splice($scope.gridOptions.data.lastIndexOf(data),1)})}function editStaffInfo(type){function sucCallback(){return function(targetEditObject){"edit"==type?angular.merge(selectedRows[0],targetEditObject):$scope.gridOptions.data.push(targetEditObject)}}var selectedRows=$scope.gridApi.selection.getSelectedRows();rockUtil.openEditModal(selectedRows,type,"editStaffInfoModal.html",sucCallback())}$scope.deleteStaff=deleteStaff,$scope.editStaffInfo=editStaffInfo,$scope.data={},$scope.gridOptions={enableHorizontalScrollbar:uiGridConstants.scrollbars.NEVER,columnDefs:[{field:"id",displayName:"员工编号",maxWidth:120,width:"30%"},{field:"name",displayName:"员工姓名",maxWidth:150},{field:"username",displayName:"登录账号",maxWidth:150},{field:"password",displayName:"登录密码",maxWidth:150}],onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.selection.on.rowSelectionChanged($scope,function(row){var selectRowCount=gridApi.selection.getSelectedRows().length;$scope.data.oneRowSelected=!1,$scope.data.multiRowSelected=!1,1===selectRowCount&&($scope.data.oneRowSelected=!0),selectRowCount>1&&($scope.data.multiRowSelected=!0)}),gridApi.selection.on.rowSelectionChangedBatch($scope,function(rows){$scope.data.multiRowSelected=!0})}},$scope.gridOptions.data=[{id:1,name:"棒槌",username:"1234",password:"*****"},{id:2,name:"棒槌2",username:"1234",password:"*****"}],angular.merge($scope.gridOptions,gridOpts.exportOpts,gridOpts.baseOpts),activate()}function androidMg(AndroidVersion,dataService,gridOpts,uiGridConstants,rockUtil,$scope){function activate(){refreshGridData(),console.log("load styleMg controller success")}function editAndroid(type){function successCall(){return function(targetEditObject){function addSuc(){return function(data){refreshGridData()}}if("edit"==type){var androidVersion=AndroidVersion.build(targetEditObject);updateAndroidVersion(androidVersion,androidVersion,function(data){refreshGridData()})}else{console.log(targetEditObject);var preAddAndroidVersion=AndroidVersion.build(targetEditObject);saveAndroidVersion(preAddAndroidVersion,addSuc())}}}var selectedRows=$scope.gridApi.selection.getSelectedRows();dataService.getUsers(null,function(data){modalObject.users=data.results,rockUtil.openEditModal(selectedRows,type,"editAndroidModal.html",successCall(),modalObject)},null)}function refreshGridData(){dataService.getAll("AndroidVersion",null,function(data){$scope.gridOptions.data=data.results})}function saveAndroidVersion(androidVersion,sucCallback){dataService.save(androidVersion.className,androidVersion,sucCallback)}function updateAndroidVersion(androidVersion,queryParams,sucCallback){dataService.update(androidVersion.className,androidVersion.objectId,queryParams,sucCallback)}var modalObject={};$scope.editAndroid=editAndroid,$scope.data={},$scope.gridOptions={enableHorizontalScrollbar:uiGridConstants.scrollbars.NEVER,columnDefs:[{field:"objectId",displayName:"版本编号",maxWidth:120,width:"30%"},{field:"version",displayName:"版本序号",maxWidth:150},{field:"updation",displayName:"版本改动",maxWidth:250},{field:"url",displayName:"版本下载地址",maxWidth:250},{field:"isLeaset",displayName:"是否最新版本",maxWidth:150}],onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.selection.on.rowSelectionChanged($scope,function(row){var selectRowCount=gridApi.selection.getSelectedRows().length;$scope.data.oneRowSelected=!1,$scope.data.multiRowSelected=!1,1===selectRowCount&&($scope.data.oneRowSelected=!0),selectRowCount>1&&($scope.data.multiRowSelected=!0)}),gridApi.selection.on.rowSelectionChangedBatch($scope,function(rows){$scope.data.multiRowSelected=!0})}},angular.merge($scope.gridOptions,gridOpts.exportOpts,gridOpts.baseOpts),activate()}function userMgConfig($stateProvider){$stateProvider.state("app.userMg",{url:"/userMg",params:{menus:null},views:{appContentView:{templateUrl:"modules/userMg/userIndex.html",controller:"userMg"}}}).state("app.userMg.userList",{url:"/userList",views:{centerBoard:{templateUrl:"modules/userMg/userList/userList.html",controller:"userList"}}}).state("app.userMg.pointsMg",{url:"/pointsMg",views:{centerBoard:{templateUrl:"modules/userMg/pointsMg/pointsMg.html",controller:"pointsMg"}}}).state("app.userMg.styleCollectionMg",{url:"/styleCollectionMg",views:{centerBoard:{templateUrl:"modules/userMg/styleCollectionMg/styleCollectionMg.html",controller:"styleCollectionMg"}}}).state("app.userMg.userInfoMg",{url:"/userInfoMg",views:{centerBoard:{templateUrl:"modules/userMg/userInfoMg/userInfoMg.html",controller:"userInfoMg"}}}).state("app.userMg.userMsgMg",{url:"/userMsgMg",views:{centerBoard:{templateUrl:"modules/userMg/userMsgMg/userMsgMg.html",controller:"userMsgMg"}}})}function userMg($scope){function activate(){}activate()}function userList($modal,gridOpts,uiGridConstants,dataService,usersService,$scope){function activate(){function getUsersSuc(){return function(data){$scope.gridOptions.data=data.results}}function getUsersErr(){return function(error){}}usersService.get(null,getUsersSuc(),getUsersErr())}$scope.data={},$scope.gridOptions={enableHorizontalScrollbar:uiGridConstants.scrollbars.NEVER,columnDefs:[{field:"objectId",displayName:"用户id",maxWidth:120,width:"30%"},{field:"username",displayName:"用户账号",maxWidth:150},{field:"mobilePhoneNumber",displayName:"手机号码",maxWidth:150}],onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.selection.on.rowSelectionChanged($scope,function(row){console.log(row.entity);var selectRowCount=gridApi.selection.getSelectedRows().length;$scope.data.oneRowSelected=!1,$scope.data.multiRowSelected=!1,1===selectRowCount&&($scope.data.oneRowSelected=!0),selectRowCount>1&&($scope.data.multiRowSelected=!0)}),gridApi.selection.on.rowSelectionChangedBatch($scope,function(rows){$scope.data.multiRowSelected=!0})}},angular.merge($scope.gridOptions,gridOpts.exportOpts,gridOpts.baseOpts),activate()}function pointsMg(UserInfo,UserPoints,dataService,gridOpts,uiGridConstants,rockUtil,$scope){function activate(){refreshGridData(),console.log("load styleMg controller success")}function editUserPoints(type){function successCall(){return function(targetEditObject){if("edit"==type){var userPoints=UserPoints.build(targetEditObject);updateUserPoints(userPoints,userPoints,function(data){refreshGridData()})}else{var userPoints=UserPoints.build(targetEditObject);saveUserPoints(userPoints,function(data){refreshGridData()}),getUserInfo(targetEditObject.userId,function(data){var curUserInfo=UserInfo.build(data.results[0]);curUserInfo.jfen=Number(curUserInfo.jfen)+Number(targetEditObject.num),updateUserInfo(curUserInfo,curUserInfo,function(data){console.log(data)})})}}}var selectedRows=$scope.gridApi.selection.getSelectedRows();dataService.getUsers(null,function(data){modalObject.users=data.results,rockUtil.openEditModal(selectedRows,type,"editUserPointsModal.html",successCall(),modalObject)},null)}function refreshGridData(){dataService.getAll("UserPoints",null,function(data){$scope.gridOptions.data=data.results})}function saveUserPoints(userPoints,sucCallback){dataService.save(userPoints.className,userPoints,sucCallback)}function updateUserPoints(userPoints,queryParams,sucCallback){dataService.update(userPoints.className,userPoints.objectId,queryParams,sucCallback)}function getUserInfo(userId,successCall){dataService.get("UserInfo",{where:{userId:userId}},successCall)}function updateUserInfo(userInfo,queryParams,sucCallback){console.log(userInfo),dataService.update("UserInfo",userInfo.objectId,queryParams,sucCallback)}var modalObject={};$scope.editUserPoints=editUserPoints,$scope.data={},$scope.gridOptions={enableHorizontalScrollbar:uiGridConstants.scrollbars.NEVER,columnDefs:[{field:"objectId",displayName:"积分编号",maxWidth:120,width:"30%"},{field:"userId",displayName:"操作用户",maxWidth:220},{field:"num",displayName:"积分数量",maxWidth:250},{field:"reason",displayName:"加/减原因",maxWidth:250},{field:"date",displayName:"操作时间",maxWidth:150}],onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.selection.on.rowSelectionChanged($scope,function(row){var selectRowCount=gridApi.selection.getSelectedRows().length;$scope.data.oneRowSelected=!1,$scope.data.multiRowSelected=!1,1===selectRowCount&&($scope.data.oneRowSelected=!0),selectRowCount>1&&($scope.data.multiRowSelected=!0)}),gridApi.selection.on.rowSelectionChangedBatch($scope,function(rows){$scope.data.multiRowSelected=!0})}},angular.merge($scope.gridOptions,gridOpts.exportOpts,gridOpts.baseOpts),activate()}function userMsgMg(UserMsg,gridOpts,uiGridConstants,dataService,rockUtil,$scope){function activate(){refreshGridData(),console.log("load styleMg controller success")}function editUserMsg(type){function successCall(){return function(targetEditObject){function addSuc(){return function(data){refreshGridData()}}if("edit"==type){var userMsg=UserMsg.build(targetEditObject);updateUserMsg(userMsg,userMsg,function(data){refreshGridData()})}else{console.log(targetEditObject);var preAddUserMsg=UserMsg.build(targetEditObject);saveUserMsg(preAddUserMsg,addSuc())}}}var selectedRows=$scope.gridApi.selection.getSelectedRows();dataService.getUsers(null,function(data){modalObject.users=data.results,rockUtil.openEditModal(selectedRows,type,"editUserMsgModal.html",successCall(),modalObject)},null)}function refreshGridData(){dataService.getAll("UserMsg",null,function(data){console.log(data.results),$scope.gridOptions.data=data.results})}function saveUserMsg(userMsg,sucCallback){dataService.save(userMsg.className,userMsg,sucCallback)}function updateUserMsg(userMsg,queryParams,sucCallback){dataService.update(userMsg.className,userMsg.objectId,queryParams,sucCallback)}var modalObject={};modalObject.msgStatus=[{value:0,name:"未读"},{value:1,name:"已读"},{value:2,name:"用户删除"}],$scope.data={},$scope.editUserMsg=editUserMsg,$scope.gridOptions={enableHorizontalScrollbar:uiGridConstants.scrollbars.NEVER,columnDefs:[{field:"objectId",displayName:"消息id",maxWidth:120,width:"30%"},{field:"userId",displayName:"用户id",maxWidth:200},{field:"title",displayName:"消息标题",maxWidth:150},{field:"content",displayName:"消息内容",maxWidth:150},{field:"status",displayName:"消息状态",maxWidth:150}],onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.selection.on.rowSelectionChanged($scope,function(row){var selectRowCount=gridApi.selection.getSelectedRows().length;$scope.data.oneRowSelected=!1,$scope.data.multiRowSelected=!1,1===selectRowCount&&($scope.data.oneRowSelected=!0),selectRowCount>1&&($scope.data.multiRowSelected=!0)}),gridApi.selection.on.rowSelectionChangedBatch($scope,function(rows){$scope.data.multiRowSelected=!0})}},angular.merge($scope.gridOptions,gridOpts.exportOpts,gridOpts.baseOpts),activate()}function userInfoMg(UserInfo,dataService,gridOpts,uiGridConstants,rockUtil,$scope){function activate(){refreshGridData(),console.log("load styleMg controller success")}function editUserInfo(type){function successCall(){return function(targetEditObject){function addSuc(){return function(data){refreshGridData()}}if("edit"==type){var UserInfo=UserInfo.build(targetEditObject);updateUserInfo(UserInfo,UserInfo,function(data){refreshGridData()})}else{console.log(targetEditObject);var preAddUserInfo=UserInfo.build(targetEditObject);saveUserInfo(preAddUserInfo,addSuc())}}}var selectedRows=$scope.gridApi.selection.getSelectedRows();dataService.getUsers(null,function(data){modalObject.users=data.results,rockUtil.openEditModal(selectedRows,type,"editUserInfoModal.html",successCall(),modalObject)},null)}function refreshGridData(){dataService.getAll("UserInfo",null,function(data){$scope.gridOptions.data=data.results})}function saveUserInfo(UserInfo,sucCallback){dataService.save(UserInfo.className,UserInfo,sucCallback)}function updateUserInfo(UserInfo,queryParams,sucCallback){}var modalObject={};$scope.editUserInfo=editUserInfo,$scope.data={},$scope.gridOptions={enableHorizontalScrollbar:uiGridConstants.scrollbars.NEVER,columnDefs:[{field:"objectId",displayName:"积分编号",maxWidth:120,width:"30%"},{field:"userId",displayName:"操作用户",maxWidth:150},{field:"num",displayName:"积分数量",maxWidth:250},{field:"reason",displayName:"加/减原因",maxWidth:250},{field:"date",displayName:"操作时间",maxWidth:150}],onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.selection.on.rowSelectionChanged($scope,function(row){var selectRowCount=gridApi.selection.getSelectedRows().length;$scope.data.oneRowSelected=!1,$scope.data.multiRowSelected=!1,1===selectRowCount&&($scope.data.oneRowSelected=!0),selectRowCount>1&&($scope.data.multiRowSelected=!0)}),gridApi.selection.on.rowSelectionChangedBatch($scope,function(rows){$scope.data.multiRowSelected=!0})}},angular.merge($scope.gridOptions,gridOpts.exportOpts,gridOpts.baseOpts),activate()}function styleCollectionMg($scope){function activate(){console.log("load styleCollectionMg controller success")}activate()}angular.module("app",["app.core","app.config","app.value","app.service","app.directive","app.controller"]),angular.module("app.core",["restangular","ui.bootstrap","ui.tree","ui.grid","ui.grid.edit","ui.grid.selection","ui.grid.exporter","ui.grid.resizeColumns","ui.grid.moveColumns","ui.router"]),angular.module("app.config",["ui.router"]),angular.module("app.service",[]),angular.module("app.value",[]),angular.module("app.controller",[]),angular.module("app.directive",[]),angular.module("app.config").config(["$stateProvider","$urlRouterProvider","RestangularProvider",config]),angular.module("app.config").config(["$stateProvider","$urlRouterProvider",routeConfig]),angular.module("app.value").value("appName","易装修后台管理平台"),angular.module("app.value").value("menus",[{name:"内容管理",url:"app.contentMg",subMenus:[{name:"活动管理",url:"",subMenus:[{name:"活动管理",url:"app.contentMg.activityMg"}]},{name:"风格管理",url:"",subMenus:[{name:"风格管理",url:"app.contentMg.styleMg"},{name:"预约管理",url:"app.contentMg.subscribeMg"}]},{name:"服务管理",url:"",subMenus:[{name:"项目管理",url:"app.contentMg.projectMg"},{name:"团队管理",url:"app.contentMg.teamMg"},{name:"报价管理",url:"app.contentMg.quoteMg"}]}]},{name:"用户管理",url:"app.userMg",subMenus:[{name:"用户管理",url:"",subMenus:[{name:"用户列表",url:"app.userMg.userList"},{name:"用户积分管理",url:"app.userMg.pointsMg"},{name:"用户信息管理",url:"app.userMg.userInfoMg"},{name:"用户消息管理",url:"app.userMg.userMsgMg"}]}]},{name:"系统设置",url:"app.systemMg",subMenus:[{name:"员工管理",url:"",subMenus:[{name:"员工管理",url:"app.systemMg.staffMg"}]},{name:"APP管理",url:"",subMenus:[{name:"安卓版本管理",url:"app.systemMg.androidMg"}]}]}]),angular.module("app.value").value("gridOpts",{exportOpts:{exporterCsvFilename:"myFile.csv",exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(currentPage,pageCount){return{text:currentPage.toString()+" of "+pageCount.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(docDefinition){return docDefinition.styles.headerStyle={fontSize:22,bold:!0},docDefinition.styles.footerStyle={fontSize:10,bold:!0},docDefinition},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location"))},baseOpts:{enableGridMenu:!0,enableSorting:!0,enableColumnResizing:!0,enableRowSelection:!0,enableSelectAll:!0}}),angular.module("app.controller").factory("Style",function(){function Style(objectId,name,avatar,images){this.objectId=objectId,this.name=name,this.avatar=avatar,this.images=images}return Style.prototype.toString=function(){return Style.name},Style.prototype.setId=function(id){this.objectId=id},Style.build=function(data){return new Style(data.objectId,data.name,data.avatar,data.images)},Style}),angular.module("app.controller").factory("UserInfo",function(){function UserInfo(objectId,userId,alias,roomstatus,roomarea,jfen){this.objectId=objectId,this.userId=userId,this.alias=alias,this.roomstatus=roomstatus,this.roomarea=roomarea,this.jfen=jfen}return UserInfo.prototype.toString=function(){return UserInfo.name},UserInfo.prototype.setId=function(id){this.userId=id},UserInfo.prototype.setRoomStatus=function(value){this.roomstatus=value},
UserInfo.prototype.setJfen=function(value){this.jfen=value},UserInfo.build=function(data){return new UserInfo(data.objectId,data.userId,data.alias,data.roomstatus,data.jfen,data.roomarea)},UserInfo}),angular.module("app.controller").factory("Team",function(){function Team(objectId,name,avatar,type){this.objectId=objectId,this.name=name,this.avatar=avatar,this.type=type}return Team.prototype.toString=function(){return Team.name},Team.prototype.setId=function(id){this.objectId=id},Team.build=function(data){return new Team(data.objectId,data.name,data.avatar,data.type)},Team}),angular.module("app.controller").factory("Project",function(){function Project(objectId,userId,styleName,styleAvatar,roomInfo,startDate,endDate,jzTeam,sjTeam,jlTeam,periodId,periods){this.objectId=objectId,this.userId=userId,this.styleName=styleName,this.styleAvatar=styleAvatar,this.roomInfo=roomInfo,this.startDate=startDate,this.endDate=endDate,this.jzTeam=jzTeam,this.sjTeam=sjTeam,this.jlTeam=jlTeam,this.periodId=periodId,this.periods=periods}return Project.prototype.toString=function(){return Project.name},Project.prototype.setId=function(id){this.objectId=id},Project.prototype.setPeriodId=function(periodId){this.periodId=periodId},Project.prototype.setPeriods=function(periods){this.periods=periods},Project.prototype.getPeriods=function(){return this.periods},Project.build=function(data){return new Project(data.objectId,data.userId,data.styleName,data.styleAvatar,data.roomInfo,data.startDate,data.endDate,data.jzTeam,data.sjTeam,data.jlTeam,data.periodId,data.periods)},Project}),angular.module("app.controller").factory("UserMsg",function(){function UserMsg(objectId,userId,title,content,status){this.objectId=objectId,this.userId=userId,this.title=title,this.content=content,this.status=status}return UserMsg.prototype.className="UserMsg",UserMsg.build=function(data){return new UserMsg(data.objectId,data.userId,data.title,data.content,data.status)},UserMsg}),angular.module("app.controller").factory("AndroidVersion",function(){function AndroidVersion(objectId,version,updation,url,isLeaset){this.objectId=objectId,this.version=version,this.updation=updation,this.url=url,this.isLeaset=isLeaset}return AndroidVersion.prototype.className="AndroidVersion",AndroidVersion.build=function(data){return new AndroidVersion(data.objectId,data.version,data.updation,data.url,data.isLeaset)},AndroidVersion}),angular.module("app.controller").factory("UserPoints",function(){function UserPoints(objectId,userId,num,reason,date){this.objectId=objectId,this.userId=userId,this.num=num,this.reason=reason,this.date=date}return UserPoints.prototype.className="UserPoints",UserPoints.build=function(data){return new UserPoints(data.objectId,data.userId,data.num,data.reason,data.date)},UserPoints}),angular.module("app.service").factory("dataService",dataService),dataService.$inject=["Restangular"],angular.module("app.service").factory("usersService",usersService),usersService.$inject=["Restangular"],angular.module("app.service").factory("rockUtil",rockUtil),rockUtil.$inject=["$modal","Restangular"],angular.module("app.controller").controller("mainCtrl",mainCtrl),mainCtrl.$inject=["appName","$scope"],angular.module("app.config").config(["$stateProvider",appConfig]),angular.module("app.controller").controller("app",app),app.$inject=["menus","$scope"],angular.module("app.directive").directive("appHeader",function(){function link(scope,element,attrs){}var directive={link:link,templateUrl:"modules/component/appHeader/appHeader.html",scope:{menus:"="},restrict:"E",controller:"appHeader"};return directive}),angular.module("app.controller").controller("appHeader",appHeader),appHeader.$inject=["$state","appName","$scope"],angular.module("app.directive").directive("appSider",function(){function link(scope,element,attrs){}var directive={link:link,templateUrl:"modules/component/appSider/appSider.html",scope:{},controller:"appSider"};return directive}),angular.module("app.controller").controller("appSider",appSider),appSider.$inject=["$stateParams","$state","$scope"],angular.module("app.config").config(["$stateProvider",contentMgConfig]),angular.module("app.controller").controller("contentMg",contentMg),contentMg.$inject=["$scope"],angular.module("app.controller").controller("activityMg",activityMg),activityMg.$inject=["$scope"],angular.module("app.controller").controller("projectMg",projectMg),projectMg.$inject=["Project","Team","gridOpts","uiGridConstants","dataService","rockUtil","$scope"],angular.module("app.controller").controller("quoteMg",quoteMg),quoteMg.$inject=["$scope"],angular.module("app.controller").controller("styleMg",styleMg),styleMg.$inject=["Style","gridOpts","uiGridConstants","dataService","rockUtil","$scope"],angular.module("app.controller").controller("subscribeMg",subscribeMg),subscribeMg.$inject=["$scope"],angular.module("app.controller").controller("teamMg",teamMg),teamMg.$inject=["Team","gridOpts","uiGridConstants","dataService","rockUtil","$scope"],angular.module("app.config").config(["$stateProvider",systemMgConfig]),angular.module("app.controller").controller("systemMg",systemMg),systemMg.$inject=["$scope"],angular.module("app.controller").controller("staffMg",staffMg),staffMg.$inject=["$modal","gridOpts","uiGridConstants","rockUtil","$scope"],angular.module("app.controller").controller("androidMg",androidMg),androidMg.$inject=["AndroidVersion","dataService","gridOpts","uiGridConstants","rockUtil","$scope"],angular.module("app.config").config(["$stateProvider",userMgConfig]),angular.module("app.controller").controller("userMg",userMg),userMg.$inject=["$scope"],angular.module("app.controller").controller("userList",userList),userList.$inject=["$modal","gridOpts","uiGridConstants","dataService","usersService","$scope"],angular.module("app.controller").controller("pointsMg",pointsMg),pointsMg.$inject=["UserInfo","UserPoints","dataService","gridOpts","uiGridConstants","rockUtil","$scope"],angular.module("app.controller").controller("userMsgMg",userMsgMg),userMsgMg.$inject=["UserMsg","gridOpts","uiGridConstants","dataService","rockUtil","$scope"],angular.module("app.controller").controller("userInfoMg",userInfoMg),userInfoMg.$inject=["UserInfo","dataService","gridOpts","uiGridConstants","rockUtil","$scope"],angular.module("app.controller").controller("styleCollectionMg",styleCollectionMg),styleCollectionMg.$inject=["$scope"];